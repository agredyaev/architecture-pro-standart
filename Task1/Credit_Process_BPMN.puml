@startuml
!theme plain
title BPMN-диаграмма: Процесс обработки заявки на кредит

|Клиент|
start
:Подать заявку в отделении;

|Сотрудник фронт-офиса|
:Оформить заявку;

|АБС|
:Заявка сохранена;
note right: Заявка ожидает пакетной выгрузки

|#AntiqueWhite|Процесс пакетной обработки|
note right: **Узкое место:**\nПакетная передача\nзаявок в КК
:<color:violet>Event</color>:**Раз в сутки**;
:Пакет заявок передан;

|Кредитный конвейер|
:Заявка зарегистрирована;

|Сотрудник бэк-офиса (кредиты)|
:Открыть заявку в КК;

|Кредитный конвейер|
:Инициировать скоринг;

|Система скоринга|
note left
  Данные для скоринга
  (из АБС и КК)
  уже загружены в систему
  скоринга в рамках
  другого пакетного процесса
end note
:Запросить данные из БКИ (API);
:Рассчитать скоринговый балл;
:Передать результат в КК;

|Кредитный конвейер|
:Скоринг получен;

|Сотрудник бэк-офиса (кредиты)|
:Принять решение по заявке;
if (Решение?) then (Одобрить)
    :Заявка одобрена;
else (Отказать)
    :Заявка отклонена;
endif

|Кредитный конвейер|
:Статус заявки обновлен;

|#AntiqueWhite|Процесс пакетной обработки|
note right: **Узкое место:**\nПакетная передача\nстатусов в АБС
:<color:violet>Event</color>:**Раз в сутки**;
:Статус заявки передан в АБС;

|АБС|
:Статус заявки обновлен;
:Информировать клиента;

|СМС-шлюз|
:Отправить СМС;

|Клиент|
:Получить СМС с решением;
stop

@enduml